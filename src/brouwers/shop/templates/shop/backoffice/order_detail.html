{% extends "base.html" %}
{% load i18n shop %}

{% block title %}
{% blocktrans with ref=order.reference %}Shop backoffice | Order {{ ref }}{% endblocktrans %}
{% endblock %}

{% block body-class %}shop-backoffice{% endblock body-class %}


{% block eye-catcher %}
    <header class="container-fluid eye-catcher">
        <div class="container">
            <h1>
                {{ order.reference }} <small>&mdash; {{ order.get_full_name }}</small>
                <i class="pull-right fa fa-shopping-bag fa-2x"></i>
            </h1>
            <a href="{% url 'shop:order-list' %}" class="backlink backlink--light">
                <i class="fa fa-long-arrow-left" aria-hidden="true"></i>
                {% trans "back to overview" %}
            </a>

            <p>{% blocktrans trimmed %}
                All the details of the shop order.
            {% endblocktrans %}</p>
        </div>
    </header>
{% endblock %}

{% block content %}
<article class="order-detail">

    <section class="order-detail__status">
        <h2>{% trans "Status" %}</h2>

        <p>{{ order.get_status_display }}</p>

        <h3>
            {% trans "Payment" %}
        </h3>
        <p>{% blocktrans with method=order.payment.payment_method.name trimmed %}
            Payment using: {{ method }}
        {% endblocktrans %}</p>
        <p>{{ order.payment.get_status_display }}</p>
    </section>

    <section class="order-detail__products">
        <h2>
            {% trans "Products" %}
            <span class="badge">{{ num_products }}</span>
        </h2>
        <ul>
            {% for cart_product in order.cart.products.all %}
                <li>
                    <p>{{ cart_product.product.name }} x {{ cart_product.amount }}</p>
                    <p>
                        {% trans "Product details:" %}
                        <br>
                        <br>
                        {% trans "Model name" %}: {{ cart_product.product.model_name }}
                    </p>
                    <img src="{{ cart_product.product.get_image_url }}" class="img-responsive">
                </li>
            {% endfor %}
        </ul>
    </section>

    <div class="order-detail__customer">

        <section class="order-detail__address order-detail__address--delivery">
            <h2>{% trans "Delivery address" %}</h2>

            {% include "shop/includes/address.html" with address=order.delivery_address %}
        </section>

        <section class="order-detail__address order-detail__address--invoice">
            <h2>{% trans "Invoice address" %}</h2>

            {% if not order.invoice_address %}
                <p>{% trans "Same as delivery address." %}</p>
            {% else %}
                {% include "shop/includes/address.html" with address=order.invoice_address %}
            {% endif %}
        </section>

        <aside class="order-detail__meta">
            <h2>{% trans "Details" %}</h2>
            <p>
                Customer name: <strong>{{ order.get_full_name }}</strong>
            </p>
            <p>
                Contact details:
                <ul>
                    <li><a href="mailto:{{ order.email }}">{{ order.email }}</a></li>
                    {% if order.phone %}
                        <li><a href="tel:{{ order.phone }}">{{ order.phone }}</a></li>
                    {% endif %}
                </ul>
            </p>
            <p>
                Created:
                <time
                    datetime="{{ order.created.isoformat }}"
                    title="{{ order.created }}"
                > {{ order.created|timesince }} ago </time>
            </p>
            <p>
                Last modified:
                <time
                    datetime="{{ order.modified.isoformat }}"
                    title="{{ order.modified }}"
                > {{ order.modified|timesince }} ago </time>
            </p>
            <p>
                Language: {{ order.get_language_display }}
            </p>

        </aside>
    </div>

</article>
{% endblock %}

